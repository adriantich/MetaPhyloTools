% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/haploNet_data.R
\name{haploNet_data}
\alias{haploNet_data}
\title{Create haplotype network data for visualization}
\usage{
haploNet_data(
  motu_tab,
  metadata,
  grouping_col,
  sample_col,
  seq_col,
  id_col,
  size_correction = 1
)
}
\arguments{
\item{motu_tab}{A data.frame containing MOTU abundance data. Rows represent MOTUs/haplotypes,
columns represent samples. Must include columns specified by \code{id_col} and \code{seq_col}.}

\item{metadata}{A data.frame containing sample metadata with grouping information.
Must include columns specified by \code{grouping_col} and \code{sample_col}.}

\item{grouping_col}{Character string. Name of the column in \code{metadata} that contains
the grouping variable (e.g., "treatment", "location").}

\item{sample_col}{Character string. Name of the column in \code{metadata} that contains
sample identifiers matching column names in \code{motu_tab}.}

\item{seq_col}{Character string. Name of the column in \code{motu_tab} that contains
DNA sequences for haplotype analysis.}

\item{id_col}{Character string. Name of the column in \code{motu_tab} that contains
unique identifiers for each MOTU/haplotype.}

\item{size_correction}{Numeric. Factor to correct haplotype frequencies for visualization.
Default is 1 (no correction).}
}
\value{
A list containing two elements:
  \item{network}{A haplotype network object created by \code{pegas::haploNet()}, or NULL if
    only one haplotype is found. Contains network structure with frequency attributes.}
  \item{pieseas}{A matrix with haplotypes as rows and groups as columns, containing
    mean abundances for pie chart visualization.}
}
\description{
This function processes MOTU (Molecular Operational Taxonomic Unit) data and metadata
to create a haplotype network and associated pie chart data for phylogenetic analysis.
It calculates mean abundances across samples grouped by a specified variable and
generates network data suitable for haplotype network visualization.
}
\details{
The function performs the following steps:
\enumerate{
  \item Groups samples by the specified grouping variable
  \item Calculates mean abundances for each MOTU across samples within each group
  \item Filters out MOTUs with zero total abundance
  \item Converts DNA sequences to DNAbin format for phylogenetic analysis
  \item Creates haplotypes and constructs a haplotype network
  \item Attaches frequency information to the network for visualization
}
}
\note{
\itemize{
  \item Requires packages \code{ape} and \code{pegas}
  \item DNA sequences should be aligned and of equal length
  \item Sample identifiers in metadata must match column names in motu_tab
  \item If only one haplotype is found, network will be NULL with a warning
}
}
\examples{
\dontrun{
# Example usage
result <- haploNet_data(
  motu_tab = my_motu_data,
  metadata = my_metadata,
  grouping_col = "treatment",
  sample_col = "sample_id",
  seq_col = "sequence",
  id_col = "motu_id",
  size_correction = 100
)

# Access results
network <- result$network
pie_data <- result$pieseas
}

}
